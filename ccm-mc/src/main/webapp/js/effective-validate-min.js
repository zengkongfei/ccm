(function(a){a.extend(a.fn,{effectiveAndValidate:function(b,c){a.validator.addMethod("pattern",function(e,d,f){return f.test(e)},"format error");a.validator.addMethod("pattern2",function(e,d,f){return f.test(e)},"format error");a.validator.addMethod("byterangelength",function(h,f,j){var g=0;for(var e=0,d=h.length;e<d;e++){g+=(h.charCodeAt(e)<255)?1:2}return this.optional(f)||(g>=j[0]&&g<=j[1])},a.validator.format("Please enter a value between {0} and {1} bytes long."));return new a.EffectiveAndValidate(c,this.validate(b),this[0])}});a.EffectiveAndValidate=function(c,d,b){this.settings=a.extend(true,{},a.EffectiveAndValidate.defaults,c||{});this.form=b;this.validate=d;this.init()};a.extend(a.EffectiveAndValidate,{defaults:{debug:false,ignoreSelectors:[],wrapSelector:"p",loadOnFocus:true,inputNormalClass:"normal",inputHoverClass:"hover",inputFocusClass:"focus",inputErrorClass:"error",message:{tag:"span",defaultClass:"message",errorClass:"error"},event:{mouseover:function(d,b,c){if(d.hasFocus()||d.hasError()){this.settings.debug&&window.console&&console.info("trigger mouseover event, current line is focused or has error");return}c.addClass(this.settings.inputHoverClass);b.showMessage()},mouseout:function(d,b,c){if(d.hasFocus()||d.hasError()){this.settings.debug&&window.console&&console.info("trigger mouseout event, current line is focused or has error");return}c.removeClass(this.settings.inputHoverClass);b.hideMessage()},focus:function(d,b,c){a(b).select();if(d.hasError()){this.settings.debug&&window.console&&console.info("trigger focus event, current line has error");return}c.removeClass(this.settings.inputHoverClass).addClass(this.settings.inputFocusClass);b.showMessage()},blur:function(d,b,c){if(d.hasError()){this.settings.debug&&window.console&&console.info("trigger blur event, current line has error");return}c.removeClass(this.settings.inputHoverClass+" "+this.settings.inputFocusClass);b.hideMessage();this.validate.element(b)}}},setDefaults:function(b){a.extend(a.EffectAndValidate.defaults,b)},prototype:{init:function(){var b=this;a(this.form).find(this.settings.wrapSelector).each(function(c){var d=a(this).find("input, select, textarea").not(":submit, :reset, [disabled]").not(b.settings.ignoreSelectors.join(", ")).addClass(b.settings.inputNormalClass);b.settings.debug&&window.console&&console.info("init effective validate, %d element(s) is selected",d.length);if(d.length>0){b.bindMessage(d,b);b.bindEvent(d,b)}if(b.settings.loadOnFocus&&(c==0)){b.settings.debug&&window.console&&console.info("init neet load on focus, focus in element name: %s",d.first().attr("name"));d.first().focus()}})},bindMessage:function(c,b){b.settings.debug&&window.console&&console.info("init execute bindMessage");var d=c.first().attr("title");c.each(function(){a.extend(this,{messageBox:a(this).parents(b.settings.wrapSelector).find(b.settings.message.tag+"."+b.settings.message.defaultClass),showMessage:function(){b.settings.debug&&window.console&&console.info("trigger showMessage event, element name: %s, message: %s, current class: %s",this.name,d,a(this).attr("class"));this.messageBox.show().removeClass(b.settings.message.errorClass).text(d||"")},showError:function(e){b.settings.debug&&window.console&&console.info("trigger showError event, element name: %s, message: %s, current class: %s",this.name,e,a(this).attr("class"));this.messageBox.show().addClass(b.settings.message.errorClass).text(e)},hideMessage:function(){b.settings.debug&&window.console&&console.info("trigger hideMessage event, hide element name: %s message, current class: %s",this.name,a(this).attr("class"));this.messageBox.text("").hide()},hasFocus:function(){b.settings.debug&&window.console&&console.info("trigger hasFocus event, element name: %s, current class: %s",this.name,a(this).attr("class"));return a(this).attr("class").indexOf(b.settings.inputFocusClass)>-1},hasError:function(){b.settings.debug&&window.console&&console.info("trigger hasError event, element name: %s, current class: %s",this.name,a(this).attr("class"));return a(this).attr("class").indexOf(b.settings.inputErrorClass)>-1}})})},bindEvent:function(c,b){b.settings.debug&&window.console&&console.info("init execute bindEvent");var d;c.each(function(f){b.settings.debug&&window.console&&console.info("bindEvent, element No.%d, name: %s",f,a(this).attr("name"));if(f==0){d=this;b.settings.debug&&window.console&&console.info("bindEvent find first element, element No.%d, name: %s",f,a(this).attr("name"))}var e=this;a.each(b.settings.event,function(g,h){b.settings.debug&&window.console&&console.info("bindEvent start bind %s event",g);if(!!a(e).attr("ignore"+g)){b.settings.debug&&window.console&&console.info("bindEvent ignore %s event, name %s, ignore focus",g,a(e).attr("name"));return}a(e).bind(g,function(){h.call(b,d,e,c);b.settings.debug&&window.console&&console.info("bindEvent, bind %s event on element name: %s",g,a(e).attr("name"))})})})}}})})(jQuery);
