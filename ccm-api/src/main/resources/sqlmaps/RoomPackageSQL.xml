<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="RoomPackageSQL">
	<typeAlias alias="roomPackage" type="com.ccm.api.model.ratePlan.RoomPackage" />
	
	<insert id="addRoomPackage" parameterClass="roomPackage">
		INSERT INTO room_package
            (roomPackageId, roomRateId, packageId, createdBy, createdTime, updatedBy, lastModifyTime, delFlag)
		VALUES (#roomPackageId#, #roomRateId#, #packageId#, #createdBy#, #createdTime#, #updatedBy#, #lastModifyTime#, #delFlag#);
	</insert>
	
	<insert id="addBatchRoomPackages" parameterClass="java.util.List">
	    <![CDATA[
	        insert into room_package
	        		(roomPackageId, roomRateId, packageId, createdBy, createdTime, updatedBy, lastModifyTime, delFlag)
	        values
	    ]]>
		<iterate conjunction=",">
	      <![CDATA[
	          (
	              #list[].roomPackageId#,
	              #list[].roomRateId#,
	              #list[].packageId#,
	              #list[].createdBy#,
	              #list[].createdTime#,
	              #list[].updatedBy#,
	              #list[].lastModifyTime#,
	              #list[].delFlag#
	          )
	      ]]>
		</iterate>
	</insert>
	
	<select id="getRoomPackage" resultClass="roomPackage">
		SELECT * FROM room_package WHERE delFlag =0 and roomPackageId=#value#
    </select>
    
    <select id="getRoomPackageByRoomRateId" resultClass="roomPackage">
		SELECT t1.*,t2.packageName FROM room_package t1 
							  LEFT JOIN package_i18n t2 ON t1.packageId = t2.packageId
							        AND t2.delFlag = 0 AND t2.language = #language# 
								  WHERE t1.delFlag = 0 and t1.roomRateId=#roomRateId#                 
    </select>
    <update id="updateRoomPackage" parameterClass="roomPackage">
    	UPDATE room_package
			SET roomPackageId = #roomPackageId#, roomRateId = #roomRateId#, packageId = #packageId#, createdBy = #createdBy#, createdTime = #createdTime#, updatedBy = #updatedBy#, lastModifyTime = #lastModifyTime#
		WHERE roomPackageId = #roomPackageId#;;
    </update>
    <delete id="deleteRoomPackageByRoomRateId">
	    DELETE
			FROM room_package
		WHERE roomRateId = #value#
    </delete>
</sqlMap>